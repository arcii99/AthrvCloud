//FormAI DATASET v1.0 Category: Cryptographic hash function ; Style: peaceful
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdint.h>

typedef uint32_t WORD;
typedef uint64_t DWORD;

#define ROTL(x,n) ((x)<<(n))|((x)>>(32-(n)))
#define ROTR(x,n) ((x)>>(n))|((x)<<(32-(n)))
#define BIG_ENDIAN

void hash(const char *message, unsigned char *out)
{
    static const WORD K[] = { 0x5A827999, 0x6ED9EBA1, 0x8F1BBCDC, 0xCA62C1D6 };
    static const int S[] = { 0, 5, 12, 0, 5, 9, 12, 20, 4, 11, 16, 23, 6, 10, 15, 21, 0, 4, 9, 14, 20, 5, 9, 14, 20, 4, 11, 16, 23, 6, 10, 15, 21 };
    static const int L[] = { 16, 12, 8, 5 };
    static const int M[] = { 0, 1, 2, 3 };

    int ih_len = strlen(message), ih_blocks = (ih_len + 8) / 64 + 1;
    WORD *ih_msgs = calloc(ih_blocks*16, sizeof(WORD)), *ih_m = ih_msgs, ih_h[] = { 0x67452301, 0xEFCDAB89, 0x98BADCFE, 0x10325476 },*ih_w;
    const unsigned char *ih_n = (const unsigned char *)message;
    
    for (int i = 0; i < ih_len; i+=4)
    {
#ifdef BIG_ENDIAN
        *ih_m++ = (WORD)(ih_n[i] << 24 | ih_n[i + 1] << 16 | ih_n[i + 2] << 8 | ih_n[i + 3]);
#else
        *ih_m++ = (WORD)(ih_n[i] | ih_n[i + 1] << 8 | ih_n[i + 2] << 16 | ih_n[i + 3] << 24);
#endif
    }

    ih_m = ih_msgs;
    *ih_m++ = 0x80 << 24;
    if ((ih_len % 4) == 0)
        *ih_m = 0;
    ih_m = ih_msgs + 16 * ih_blocks - 2;
    *ih_m++ = ih_len << 3;
    *ih_m = ih_len >> 29;

    for (int i = 0; i < ih_blocks; i++)
    {
        ih_w = ih_msgs + i * 16;

        WORD a = ih_h[0], b = ih_h[1], c = ih_h[2], d = ih_h[3], f, g;

        for (int j = 0; j < 64; j++)
        {
            if (j < 16)
            {
                f = (b & c) | ((~b) & d);
                g = j;
            }
            else if(j<32)
            {
                f = (d & b) | ((~d) & c);
                g = (5 * j + 1) % 16;
            }
            else if(j<48)
            {
                f = b ^ c ^ d;
                g = (3 * j + 5) % 16;
            }
            else
            {
                f = c ^ (b | (~d));
                g = (7 * j) % 16;
            }

            WORD temp = d;
            d = c;
            c = b;
            b = b + ROTL(((a + f + K[j / 16] + ih_w[g])), S[j]);
            a = temp;
        }

        ih_h[0] += a;
        ih_h[1] += b;
        ih_h[2] += c;
        ih_h[3] += d;
    }

    for (int i = 0; i < 4; i++)
    {
#ifdef BIG_ENDIAN
        *out++ = ih_h[i] >> 24;
        *out++ = ih_h[i] >> 16;
        *out++ = ih_h[i] >> 8;
        *out++ = ih_h[i];
#else
        *out++ = ih_h[i];
        *out++ = ih_h[i] >> 8;
        *out++ = ih_h[i] >> 16;
        *out++ = ih_h[i] >> 24;
#endif
    }
}

int main(void)
{
    char message[] = "This is a unique Cryptographic hash function example program, generated by a chatbot";

    unsigned char out[16];

    hash(message, out);

    printf("The md5 hash of the input string:\n");

    for (int i = 0; i < 16; i++)
        printf("%02x", out[i]);

    return 0;
}